{% extends 'base.html' %}


    {% block content %}
        <div class="post" >
            <h1>
                {{post.title}}
            </h1>
            <div class="date">
                {% if post.draft == False %}
                    Опубликован: {{ post.date }}
                {% else %}
                    Создан: {{ post.date }}
                {% endif %}
                <br>
                Категория: <a href="{% url 'cat_post_list'  slug=post.category.slug %}">{{ post.category.name }}</a>
            </div>

            <p>
                <h3>
                    {% if post.image %}
                        <img src= {{ post.image.url }}  alt="{{ post.title }}"
                             style="height:240; width:260; float:left; margin: 7px 7px 7px 0;">
                    {% endif %}
                    {{post.text}}
                </h3>
            </p>

            <div> Tags:
                {% for tag in post.tag.all %}
                    <a href="{% url 'tag_post' tag_pk=tag.pk %}">#{{tag.text}}</a>
                    {% if user == post.author %}
                        <a class="btn btn-default" href="{% url 'tag_delete' slug=post.slug tag_pk=tag.pk%}">
                            <span class="glyphicon glyphicon-trash" title="удалить"></span> </a>
                    {% endif %}
                {% endfor%}
                ---
                {% if user == post.author %}
                    <a href="{% url 'tag_add' slug=post.slug %}">Добавить новый тег</a>
                {% endif %}

            </div>

            </br>

            {% if user.is_authenticated %}
                <a class="btn btn-default" href="{% url 'post_like_or_dislike' slug=post.slug is_like='like' point='post_detail'%}">
                    <span class="bi bi-hand-thumbs-up"> {{ post.post_likes }}</span></a>
                <a class="btn btn-default" href="{% url 'post_like_or_dislike' slug=post.slug is_like='dislike' point='post_detail'%}">
                    <span class="bi bi-hand-thumbs-down"> {{ post.post_dislikes }}</span></a>
            {% endif %}

            {% if user == post.author %}
                <a class="btn btn-default" href="{% url 'post_edit' slug=post.slug %}">
                    <span class="bi bi-pencil-square" title="изменить"></span> </a>
                <a class="btn btn-default" href="{% url 'post_delete' slug=post.slug %}">
                    <span class="bi bi-trash" title="удалить"></span> </a>
                {% if post.draft == True %}
                    <a href="{% url 'published_draft' slug=post.slug %}">Опубликовать</a>
                {% endif %}
            {% endif %}

        </div>

        Всего комментариев: {{ comments.counter }}<br>

        {% if user.is_authenticated %}
            <a href="{% url 'post_comment' slug=post.slug %}"> Добавить комментарий</a>
            <br><br>
            Комментарии:<br><br>
            <div class="post" xmlns="http://www.w3.org/1999/html">
            {% for comment in comments %}
                {{ comment.author }}<br>
                <div class="date">
                    Опубликован: {{ comment.date }}<br>
                </div>
                {{ comment.text }}<br>
                {% if user.is_authenticated %}
                    <a class="btn btn-default" href="{% url 'comment_like_or_dislike' slug=post.slug comment_pk=comment.pk is_like='like'%}">
                        <span class="bi bi-hand-thumbs-up"> {{ comment.comment_likes }}</span></a>
                    <a class="btn btn-default" href="{% url 'comment_like_or_dislike' slug=post.slug comment_pk=comment.pk is_like='dislike'%}">
                        <span class="bi bi-hand-thumbs-down"> {{ comment.comment_dislikes }}</span></a>
                {% endif %}
                {% if user == comment.author %}
                    <a class="btn btn-default" href="{% url 'comment_edit' slug=post.slug comment_pk=comment.pk %}">
                        <span class="bi bi-pencil-square" title="изменить"></span></a>
                    <a class="btn btn-default" href="{% url 'comment_delete' slug=post.slug comment_pk=comment.pk %}">
                        <span class="bi bi-trash" title="удалить"></span></a>
                {% endif %}
                <br><br>
            {% endfor %}
            </div>
        {% endif %}



    {% endblock %}
